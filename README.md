# SEIRSVBH Simulator

**This repository accompanies the following article:**  
**â€œ[TODO: Article Title]â€** â€” preprint under review ([link](https://TODO.com/article))  

## Overview

The SEIRSVBH Simulator is a MATLAB-based tool consisting of **driver scripts** and an **Interactive app** **(GUI)** for parameter estimation and forward simulation of the **SEIRS-VBH model**, as detailed in the accompanying article mentioned above.

This tool reproduces the results from the accompanying article and allows users to explore additional scenarios, estimate parameters, and simulate disease dynamics under various conditions.

## Features
As detailed in the accompanying article: 
- Compute and plot the relative $l_2$ and $l_\infty$;
- Solve the **Inverse Problem** and **Direct Problem**;
- Plot the estimated parameters and compare model simulations with reported data.


## Components
- **Scripts:** `+seirsvbh/+simulator/+main/`  
- **GUI:** `+seirsvbh/+simulator/+ui/SEIRSVBHSimulator`  
  
  > **Note:** All experiments, figures, and tables in the accompanying article were produced with the MATLAB scripts in  +seirsvbh/+simulator/+main/`. The GUI provides the same computations for interactive exploration, but was not used to generate the paperâ€™s results.
---

## Repository structure

```text
SEIRSVBH_Simulator/
â””â”€â”€ +seirsvbh/
    â””â”€â”€ +simulator/
        â”‚
        â”œâ”€â”€ +ui/                   
        â”‚   â””â”€â”€ SEIRSVBHSimulator.m   â†’ MATLAB App (GUI)
        â”‚
        â”œâ”€â”€ +main/                 â†’ Driver scripts
        â”‚   â”œâ”€â”€ runRelativeErrorsDriver.m
        â”‚   â””â”€â”€ runIDPandDirectDriver.m
        â”‚
        â”œâ”€â”€ +helpers/              â†’ Utility helper functions
        â”‚   â”œâ”€â”€ loadReportedData.m
        â”‚   â”œâ”€â”€ checkInputParams.m
        â”‚   â”œâ”€â”€ checkH.m
        â”‚   â”œâ”€â”€ psiQuadratic.m
        â”‚   â””â”€â”€ styleDateAxisHelper.m
        â”‚
        â”œâ”€â”€ +functions/            â†’ Core functions
        â”‚   â”œâ”€â”€ summarizeRelativeErrorsFromMat.m
        â”‚   â”œâ”€â”€ saveRelativeErrors.m
        â”‚   â”œâ”€â”€ plotRelativeErrorsFromMatFile.m
        â”‚   â”œâ”€â”€ plotModelVsReported.m
        â”‚   â”œâ”€â”€ plotIDPSolution.m
        â”‚   â”œâ”€â”€ IDPSolver.m
        â”‚   â”œâ”€â”€ directProblemSolver.m
        â”‚   â”œâ”€â”€ computeRelativeErrorsParallel.m
        â”‚   â”œâ”€â”€ computeRelativeErrorsAt.m
        â”‚   â””â”€â”€ cauchyProblemSolver.mat
        â”‚
        â”œâ”€â”€ +data/                 â†’ Model input and parameter files
        â”‚   â”œâ”€â”€ BGDataKnownFinal.mat
        â”‚   â””â”€â”€ BGParamKnown.mat
        â”‚
        â””â”€â”€ results.mat            â†’ Output generated by scripts/app

```
##  Data files
The data files contain officially reported COVID-19 data for Bulgaria over the time period from 07 June 2020 through 12 March 2023. 

| File | Required variables |
|------|--------------------|
| **BGDataKnownFinal.mat** | `A, H, Rtotal, Vtotal, Dtotal, Htotal, I1, N1, R1` |
| **BGParamKnown.mat** | `Lambda, theta, omega, lambda, nu, mu, phi` |


##  Requirements

- MATLAB R2024a or newer  
- Parallel Computing Toolbox (for multi-worker sweeps)  
- Add the `SEIRSVBH_Simulator` folder to the path.

---

##  How to use
###  Using the scripts (reproduces the results in the accompanying article):
```matlab
runRelativeErrorsDriver.m
```
This script performs the following steps:
- Loads reported data BGDataKnownFinal.mat and BGParamKnown.mat;
-  Computes relative errors (`computeRelativeErrorsParallel`) for grids of step size $\xi$ =0.005, $c$ = 0.005;
- Saves `results.mat`;
- Summarizes minima in MATLAB console (`summarizeRelativeErrorsFromMat`);
- Generates the contour and surface plots (`plotRelativeErrorsFromMatFile`)

```matlab
runIDPandDirectDriver.m
```
This script performs the following steps:
- Loads results.mat and extracts the optimal $$(\xi, c)$$ values corresponding to the minimum relative error;
- Solves the Inverse Problems (`IDPSolver`);
- Plots the time evolution of the estimated parameters (`plotIDPSolution`);
- Solves the direct problem (`directProblemSolver`);
- Plots computed model results vs. officially reported data (`plotModelVsReported`).



###  Using the GUI (For interactive explorations)

The interactive app is organized into several functional tabs, each corresponding to a specific analytical stage:

####  **Compute and Plot Relative Errors** tab:
Users can computes and visualize the **$l_2$** and **$l_\infty$** relative errors between modeled and reported data across the **$(\xi, c)$** parameter space. 

[The "Compute and Plot Relative Errors" Tab](seirsvbh.simulator.assets.relErrTab.png)
*Figure 1: Relative Erros computation and visualization.*

 - **Procedure**
1. Choose  $\xi$ and $c$ steps. Optionally, adjust the number of workers for parallel processing.
2. Press "Compute Relative Errros" button.
3. All results are logged into the **Logger** view.
4. Choose a plot option adn press "Plot Relative Errors" button.

!

####  **Solve and Plot Inverse Problem** tab:

Performs parameter estimation by solving the **inverse problem** for the computed **$(\xi, c)$** pair, where the **$l_2$** and **$l_\infty$** relative errors reach their minimum.  

![The "Solve and Plot Inverse Problem" Tab](seirsvbh.simulator.assets.invProblemTab.png)
*Figure 1: Inverse Problem solution and visualization.*

 - **Procedure**
1. Review the pre-filled, non-editable  **$(\xi, c)$**, computed based on the **$\xi$**, **$c$** steps selected in "Compute and Plot Relative Errors" tab.
2. Press "Solve Inverse Problem button".  
4. The resulting parameters include:
- **$\alpha$** - Vaccination parameter  
- **$\beta$** - Transmission rate  
- **$\gamma$** - Recovery rate of non-hospitalized individuals  
- **$\rho$** - Hospitalization rate  
- **$\sigma$** - Recovery rate of hospitalized individuals  
- **$\tau$** - Mortality rate of infectious people
5. Choose a plot option and press "Plot Parameter" button.


####  **Solve and Plot Inverse Problem** tab:

Solves the **direct SEIRS-VBH model** forward in time using the parameters obtained from the inverse problem.  
This enables direct comparison between model outputs (**$A$**, **$V_{\text{total}}$**, **$R_{\text{total}}$**, **$D_{\text{total}}$**, **$H_{\text{total}}$**)  and the reported epidemiological data over the period **08 June 2020 â€“ 12 March 2023**.

![The "Solve and Plot Direct Problem" Tab](seirsvbh.simulator.assets.dirProblemTab.png)
*Figure 1: Direct Problem solution and visualization.*

 - **Procedure**
1. Review the pre-filled, non-editable  **$(\xi, c)$** $$, computed based on the **$\xi$**, **$c$** steps selected in "Compute and Plot Relative Errors" tab.
2. Choose a plot option and press "Plot Selected" button.



##  Logging

- All actions timestamped in the **Logger** panel  
- `Copy` / `Clear` buttons manage log contents  
---

## ðŸ“š Citation

If you use this software, please cite:

> Koleva, Veneta, Hristov, Tsvetan (2025). *SEIRSVBH Simulator*. DOI: 10.5281/zenodo.xxxxx  <!-- TODO: replace with real DOI -->

```bibtex
@software{KolevaHristov2025SEIRSVBH,
  title        = {SEIRSVBH Simulator},
  author       = {Koleva, Veneta and Hristov, Tsvetan},
  year         = {2025},
  doi          = {10.5281/zenodo.xxxxx},  % TODO: update DOI
  url          = {https://github.com/venetakoleva/SEIRSVBHSimulator}
}
```

---

## License

Code is released under the **Apache License 2.0**.  
See [`LICENSE`](./LICENSE) and attribution notices in [`NOTICE`](./NOTICE).

---

## Authors & Contact

**Veneta Koleva**  
**Tsvetan Hristov**

For questions or contributions, please open an [issue](https://github.com/venetakoleva/SEIRSVBHSimulator/issues).

---

*Last updated - October 2025.*
