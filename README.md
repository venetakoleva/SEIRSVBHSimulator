# SEIRSVBH Simulator

**This repository accompanies the following article:**  
**â€œ[TODO: Article Title]â€** â€” preprint under review ([link](https://TODO.com/article))  

## Overview

The SEIRSVBH Simulator is a MATLAB-based tool consisting of **driver scripts** and a **GUI** for parameter estimation and forward simulation of the **SEIRS-VBH model**, as detailed in the accompanying article mentioned above.

This tool reproduces the results from the accompanying article and allows users to explore additional scenarios, estimate parameters, and simulate disease dynamics under various conditions.

## Features
As detailed in the accompanying article: 
- Compute and plot the relative *l*â‚‚ and *l*âˆž;
- Solve the **Inverse Problem** and **Direct Problem**;
- Plot the estimated parameters and compare model simulations with reported data.


## Components
- **Scripts:** `+seirsvbh/+simulator/+main/`  
- **Interactive App (GUI):** `+seirsvbh/+simulator/+ui/SEIRSVBHSimulator`  
  
  > **Note:** All experiments, figures, and tables in the accompanying article were produced with the MATLAB scripts in  +seirsvbh/+simulator/+main/`. The GUI provides the same computations for interactive exploration, but was not used to generate the paperâ€™s results.
---

## Repository structure

```text
SEIRSVBH_Simulator/
â””â”€â”€ +seirsvbh/
    â””â”€â”€ +simulator/
        â”‚
        â”œâ”€â”€ +ui/                   
        â”‚   â””â”€â”€ SEIRSVBHSimulator.m   â†’ MATLAB App (GUI)
        â”‚
        â”œâ”€â”€ +main/                 â†’ Driver scripts
        â”‚   â”œâ”€â”€ runRelativeErrorsDriver.m
        â”‚   â””â”€â”€ runIDPandDirectDriver.m
        â”‚
        â”œâ”€â”€ +helpers/              â†’ Utility helper functions
        â”‚   â”œâ”€â”€ loadReportedData.m
        â”‚   â”œâ”€â”€ checkInputParams.m
        â”‚   â”œâ”€â”€ checkH.m
        â”‚   â”œâ”€â”€ psiQuadratic.m
        â”‚   â””â”€â”€ styleDateAxisHelper.m
        â”‚
        â”œâ”€â”€ +functions/            â†’ Core functions
        â”‚   â”œâ”€â”€ summarizeRelativeErrorsFromMat.m
        â”‚   â”œâ”€â”€ saveRelativeErrors.m
        â”‚   â”œâ”€â”€ plotRelativeErrorsFromMatFile.m
        â”‚   â”œâ”€â”€ plotModelVsReported.m
        â”‚   â”œâ”€â”€ plotIDPSolution.m
        â”‚   â”œâ”€â”€ IDPSolver.m
        â”‚   â”œâ”€â”€ directProblemSolver.m
        â”‚   â”œâ”€â”€ computeRelativeErrorsParallel.m
        â”‚   â”œâ”€â”€ computeRelativeErrorsAt.m
        â”‚   â””â”€â”€ cauchyProblemSolver.mat
        â”‚
        â”œâ”€â”€ +data/                 â†’ Model input and parameter files
        â”‚   â”œâ”€â”€ BGDataKnownFinal.mat
        â”‚   â””â”€â”€ BGParamKnown.mat
        â”‚
        â””â”€â”€ results.mat            â†’ Output generated by scripts/app

```
##  Requirements

- MATLAB R2024a or newer  
- Parallel Computing Toolbox (for multi-worker sweeps)  
- Add the `SEIRSVBH_Simulator` folder to the path.

---

##  Stage 1 - Relative-errors analysis

###  Using the GUI
1. Run the app:
   ```matlab
    app = seirsvbh.simulator.ui.SEIRSVBHSimulator;
   ```
2. Load **BGDataKnownFinal.mat** and **BGParamKnown.mat**.
3. Open **Compute and Plot Relative Errors** tab:
   - Choose grid resolution (`Î¾` step, `c` step)
   - Choose Ïˆ(h) (e.g. `psiQuadratic`)
   - Select number of parallel workers
4. Click **Compute Relative Errors** â†’ As a result:
   - results saved to `results.mat`
   - prints summary of minima  lâ‚‚ and lâˆž relative errors
   - prints optimal (Î¾, c) pairs to the Logger view.
6. Optionally:
   - **Plot Relative Errors** â†’ generates surface/contour plots as embedded plot 

### Using the driver script
```matlab
runRelativeErrorsDriver.m
```
This script performs the following steps:
1. Loads reported data and parameters via `helpers.loadReportedData`
2. Builds Î¾ âˆˆ [0, 1] and c âˆˆ [âˆ’0.25, 0.25] grids with step size Î¾ =0.005, c = 0.005
3. Calls  
   [l2mat, linfmat, usedParallel, nWorkersUsed] = ...
       computeRelativeErrorsParallel(xi_list, c_list, h, psiFunc, reportedData, 10, 'ii');
4. Saves `results.mat`
5. Summarizes minima (`summarizeRelativeErrorsFromMat`)
6. Generates contour plots (`plotRelativeErrorsFromMatFile`)

**Output file:**  
`results.mat` â†’ contains `Xi, C, L2mat, Linfmat, xi, c, psiName, h, usedParallel, nWorkersUsed`

---

##  Stage 2 - Inverse Data Problem and Parameter Identification

###  Using the GUI
In the **Solve and Plot Inverse Data Problem** tab:

1. Enter **(Î¾, c)** values (use minima from Stage 1).  
2. Select **Ïˆ(h)** (default: `@seirsvbh.simulator.helpers.psiQuadratic`).  
3. Click **Solve Inverse Problem** â†’ computes the initially unknown time-dependent parameters:  
   **Î±(t), Î²(t), Î³(t), Ï(t), Ïƒ(t), Ï„(t)**.  
4. Optionally:  
   - **Plot Parameters** â†’ displays the computed parameter trajectories in an embedded plot.

---

##  Stage 3 - Direct Problem Solution

### Using the GUI
In the **Solve and Plot Direct Problem** tab:

1. Enter **(Î¾, c)** values (use minima from Stage 1).  
2. Select **Ïˆ(h)** (default: `@seirsvbh.simulator.helpers.psiQuadratic`).  
3. Click **Solve Direct Problem** â†’ runs the SEIRSVBH model forward in time using the parameters obtained in Stage 2.  
4. Optionally:  
   - **Plot Selected** â†’ visualizes the simulated model components and compares them (where available) with the corresponding reported data.


### Using the driver script
```matlab
runIDPandDirectDriver.m
```

This script performs the following steps:
1. Loads results.mat and extracts the optimal (Î¾, c) values corresponding to the minimum relative error.
2. Reads the selected (Î¾, c) pair from the results file and initializes the Inverse Data Problem (IDP) solver: calls (`IDPSolver`).
3. Plots the time evolution of the parameters estimated by the IDP solver using (`plotIDPSolution`).
4. Runs the direct ODE solver using `directProblemSolver`.
5. Compares computed model output vs officially reported data using (`plotModelVsReported`).

---

##  Data files
The data files contain officially reported COVID-19 data for Bulgaria over the time period from 07 June 2020 through 12 March 2023. 

| File | Required variables |
|------|--------------------|
| **BGDataKnownFinal.mat** | `A, H, Rtotal, Vtotal, Dtotal, Htotal, I1, N1, R1` |
| **BGParamKnown.mat** | `Lambda, theta, omega, lambda, nu, mu, phi` |

---

##  Logging

- All actions timestamped in the **Logger** panel  
- `Copy` / `Clear` buttons manage log contents  
- Driver scripts also print start/end times and elapsed duration

---

## ðŸ“š Citation

If you use this software, please cite:

> Koleva, Veneta, Hristov, Tsvetan (2025). *SEIRSVBH Simulator*. DOI: 10.5281/zenodo.xxxxx  <!-- TODO: replace with real DOI -->

```bibtex
@software{KolevaHristov2025SEIRSVBH,
  title        = {SEIRSVBH Simulator},
  author       = {Koleva, Veneta and Hristov, Tsvetan},
  year         = {2025},
  doi          = {10.5281/zenodo.xxxxx},  % TODO: update DOI
  url          = {https://github.com/venetakoleva/SEIRSVBHSimulator}
}
```

---

## License

Code is released under the **Apache License 2.0**.  
See [`LICENSE`](./LICENSE) and attribution notices in [`NOTICE`](./NOTICE).

---

## Authors & Contact

**Veneta Koleva**  
**Tsvetan Hristov**

For questions or contributions, please open an [issue](https://github.com/venetakoleva/SEIRSVBHSimulator/issues).

---

*Last updated - October 2025.*
