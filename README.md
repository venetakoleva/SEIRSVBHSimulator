# üß¨ SEIRSVBH Simulator

**SEIRSVBH Simulator** is a MATLAB-based application and script suite for parameter identification and simulation of the  
**SEIRSVBH epidemiological model** (*Susceptible‚ÄìExposed‚ÄìInfectious‚ÄìRecovered‚ÄìSusceptible-Vaccinated‚ÄìHospitalized*).  
It provides both graphical and script-based workflows for:

- üîπ Computing **relative l‚ÇÇ and l‚àû errors** across (Œæ, c) parameter grids  
- üîπ Estimating parameter values that minimize the discrepancy between model predictions and reported data
- üîπ Solving the **Inverse Data Problem (IDP)** and running the **direct SEIRSVBH model**  
- üîπ Visualizing parameter trajectories and comparing model output to reported data  

## üß† Scientific Context

This simulator was developed as part of a scientific study (currently under review).  
All computational experiments and visualizations presented in the paper were performed using the MATLAB **driver scripts** in `+seirsvbh/+simulator/+main`.  
The graphical application **SEIRSVBHSimulator** (`+ui`) was additionally developed to enable interactive exploration of the SEIRSVBH model parameters and results without the need for MATLAB scripting.

---

## üóÇÔ∏è Repository structure

```text
SEIRSVBH_Simulator/
‚îî‚îÄ‚îÄ +seirsvbh/
    ‚îî‚îÄ‚îÄ +simulator/
        ‚îÇ
        ‚îú‚îÄ‚îÄ +ui/                   ‚Üí Graphical interface (App)
        ‚îÇ   ‚îî‚îÄ‚îÄ SEIRSVBHSimulator.m   ‚Üí Main MATLAB App (GUI)
        ‚îÇ
        ‚îú‚îÄ‚îÄ +main/                 ‚Üí Driver and entry scripts
        ‚îÇ   ‚îú‚îÄ‚îÄ runRelativeErrorsDriver.m
        ‚îÇ   ‚îî‚îÄ‚îÄ runIDPandDirectDriver.m
        ‚îÇ
        ‚îú‚îÄ‚îÄ +helpers/              ‚Üí Utility helper functions
        ‚îÇ   ‚îú‚îÄ‚îÄ loadReportedData.m
        ‚îÇ   ‚îú‚îÄ‚îÄ checkInputParams.m
        ‚îÇ   ‚îú‚îÄ‚îÄ checkH.m
        ‚îÇ   ‚îú‚îÄ‚îÄ psiQuadratic.m
        ‚îÇ   ‚îî‚îÄ‚îÄ styleDateAxisHelper.m
        ‚îÇ
        ‚îú‚îÄ‚îÄ +functions/            ‚Üí Core model and analysis functions
        ‚îÇ   ‚îú‚îÄ‚îÄ summarizeRelativeErrorsFromMat.m
        ‚îÇ   ‚îú‚îÄ‚îÄ saveRelativeErrors.m
        ‚îÇ   ‚îú‚îÄ‚îÄ plotRelativeErrorsFromMatFile.m
        ‚îÇ   ‚îú‚îÄ‚îÄ plotModelVsReported.m
        ‚îÇ   ‚îú‚îÄ‚îÄ plotIDPSolution.m
        ‚îÇ   ‚îú‚îÄ‚îÄ IDPSolver.m
        ‚îÇ   ‚îú‚îÄ‚îÄ directProblemSolver.m
        ‚îÇ   ‚îú‚îÄ‚îÄ computeRelativeErrorsParallel.m
        ‚îÇ   ‚îú‚îÄ‚îÄ computeRelativeErrorsAt.m
        ‚îÇ   ‚îî‚îÄ‚îÄ cauchyProblemSolver.mat
        ‚îÇ
        ‚îú‚îÄ‚îÄ +data/                 ‚Üí Model input and parameter files
        ‚îÇ   ‚îú‚îÄ‚îÄ BGDataKnownFinal.mat
        ‚îÇ   ‚îî‚îÄ‚îÄ BGParamKnown.mat
        ‚îÇ
        ‚îî‚îÄ‚îÄ results.mat            ‚Üí Output generated by scripts/app


## ‚öôÔ∏è Requirements

- MATLAB R2021b or newer  
- Parallel Computing Toolbox (for multi-worker sweeps)  
- Add the `SEIRSVBH_Simulator` folder to the path.
---

## üß© Stage 1 ‚Äî Relative-errors analysis

### üîò Using the GUI
1. Run the app:
   ```matlab
    app = seirsvbh.simulator.ui.SEIRSVBHSimulator;
   ```
2. Load **BGDataKnownFinal.mat** and **BGParamKnown.mat**.
3. Open **Compute and Plot Relative Errors** tab:
   - Choose grid resolution (`Œæ` step, `c` step)
   - Choose œà(h) (e.g. `psiQuadratic`)
   - Select number of parallel workers
4. Click **Compute Relative Errors** ‚Üí As a result:
   - results saved to `results.mat`
   - prints summary of minima  l‚ÇÇ and l‚àû relative errors
   - prints optimal (Œæ, c) pairs to the Logger view.
6. Optionally:
   - **Plot Relative Errors** ‚Üí generates surface/contour plots as embedded plot 

### üíª Using the driver script
```matlab
runRelativeErrorsDriver.m
```
This script performs the following steps:
1. Loads reported data and parameters via `helpers.loadReportedData`
2. Builds Œæ ‚àà [0, 1] and c ‚àà [‚àí0.25, 0.25] grids with step size Œæ =0.005, c = 0.005
3. Calls  
   [l2mat, linfmat, usedParallel, nWorkersUsed] = ...
       computeRelativeErrorsParallel(xi_list, c_list, h, psiFunc, reportedData, 10, 'ii');
4. Saves `results.mat`
5. Summarizes minima (`summarizeRelativeErrorsFromMat`)
6. Generates contour plots (`plotRelativeErrorsFromMatFile`)

**Output file:**  
`results.mat` ‚Üí contains `Xi, C, L2mat, Linfmat, xi, c, psiName, h, usedParallel, nWorkersUsed`

---

## üß© Stage 2 ‚Äî Inverse Data Problem and Parameter Identification

### üîò Using the GUI
In the **Solve and Plot Inverse Data Problem** tab:

1. Enter **(Œæ, c)** values (use minima from Stage 1).  
2. Select **œà(h)** (default: `@seirsvbh.simulator.helpers.psiQuadratic`).  
3. Click **Solve Inverse Problem** ‚Üí computes the initially unknown time-dependent parameters:  
   **Œ±(t), Œ≤(t), Œ≥(t), œÅ(t), œÉ(t), œÑ(t)**.  
4. Optionally:  
   - **Plot Parameters** ‚Üí displays the computed parameter trajectories in an embedded plot.

---

## üß© Stage 3 ‚Äî Direct Problem Simulation

### üîò Using the GUI
In the **Solve and Plot Direct Problem** tab:

1. Enter **(Œæ, c)** values (use minima from Stage 1).  
2. Select **œà(h)** (default: `@seirsvbh.simulator.helpers.psiQuadratic`).  
3. Click **Solve Direct Problem** ‚Üí runs the SEIRSVBH model forward in time using the parameters obtained in Stage 2.  
4. Optionally:  
   - **Plot Selected** ‚Üí visualizes the simulated model components and compares them (where available) with the corresponding reported data.


### üíª Using the driver script
```matlab
runIDPandDirectDriver.m
```

This script performs the following steps:
1. Loads results.mat and extracts the optimal (Œæ, c) values corresponding to the minimum relative error.
2. Reads the selected (Œæ, c) pair from the results file and initializes the Inverse Data Problem (IDP) solver:
   ```matlab
   idpSol = IDPSolver(xi, h, c, psiFunc, reportedData);
   ```
3. Plots the time evolution of the parameters estimated by the IDP solver using `plotIDPSolution`.
4. Runs the direct ODE solver  
   ```matlab
   ODESol = directProblemSolver(idpSol, reportedData, h);
   ```
7. Compares computed model output vs officially reported data using (`plotModelVsReported`).

---

## üßæ Data files

| File | Required variables |
|------|--------------------|
| **BGDataKnownFinal.mat** | `A, H, Rtotal, Vtotal, Dtotal, Htotal, I1, N1, R1` |
| **BGParamKnown.mat** | `Lambda, theta, omega, lambda, nu, mu, phi` |

---

## ü™µ Logging

- All actions timestamped in the **Logger** panel  
- `Copy` / `Clear` buttons manage log contents  
- Driver scripts also print start/end times and elapsed duration

---

## üìö Citation

If you use this software, please cite:

> Koleva, Veneta, Hristov, Tsvetan (2025). *SEIRSVBH Simulator*. DOI: 10.5281/zenodo.xxxxx  <!-- TODO: replace with real DOI -->

```bibtex
@software{KolevaHristov2025SEIRSVBH,
  title        = {SEIRSVBH Simulator},
  author       = {Koleva, Veneta and Hristov, Tsvetan},
  year         = {2025},
  doi          = {10.5281/zenodo.xxxxx},  % TODO: update DOI
  url          = {https://github.com/venetakoleva/SEIRSVBHSimulator}
}
```

---

## ‚öñÔ∏è License

Code is released under the **Apache License 2.0**.  
See [`LICENSE`](./LICENSE) and attribution notices in [`NOTICE`](./NOTICE).

---

## üß† Authors & Contact

**Veneta Koleva**  
**Tsvetan Hristov**

For questions or contributions, please open an [issue](https://github.com/venetakoleva/SEIRSVBHSimulator/issues).

---

*Last updated ‚Äî October 2025.*
